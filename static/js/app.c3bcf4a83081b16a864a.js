webpackJsonp([0],{"0Rhb":function(t,e){var i={},a=i.TiffTags={274:"Orientation"};function s(t){return!!t.exifdata}function o(t,e){function i(i){var a=function(t){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;var i=2,a=t.byteLength;for(;i<a;){if(255!=e.getUint8(i))return!1;if(225==e.getUint8(i+1))return g(e,i+4,e.getUint16(i+2));i+=2+e.getUint16(i+2)}}(i);t.exifdata=a||{},e&&e.call(t)}if(window.FileReader&&(t instanceof window.Blob||t instanceof window.File)){var a=new FileReader;a.onload=function(t){i(t.target.result)},a.readAsArrayBuffer(t)}}function r(t,e,i,a,n){var s,o,r,g,d,m,h=t.getUint16(e+2,!n),u=t.getUint32(e+4,!n),l=t.getUint32(e+8,!n)+i;switch(h){case 1:case 7:if(1==u)return t.getUint8(e+8,!n);for(s=u>4?l:e+8,o=[],g=0;g<u;g++)o[g]=t.getUint8(s+g);return o;case 2:return c(t,s=u>4?l:e+8,u-1);case 3:if(1==u)return t.getUint16(e+8,!n);for(s=u>2?l:e+8,o=[],g=0;g<u;g++)o[g]=t.getUint16(s+2*g,!n);return o;case 4:if(1==u)return t.getUint32(e+8,!n);for(o=[],g=0;g<u;g++)o[g]=t.getUint32(l+4*g,!n);return o;case 5:if(1==u)return d=t.getUint32(l,!n),m=t.getUint32(l+4,!n),(r=new Number(d/m)).numerator=d,r.denominator=m,r;for(o=[],g=0;g<u;g++)d=t.getUint32(l+8*g,!n),m=t.getUint32(l+4+8*g,!n),o[g]=new Number(d/m),o[g].numerator=d,o[g].denominator=m;return o;case 9:if(1==u)return t.getInt32(e+8,!n);for(o=[],g=0;g<u;g++)o[g]=t.getInt32(l+4*g,!n);return o;case 10:if(1==u)return t.getInt32(l,!n)/t.getInt32(l+4,!n);for(o=[],g=0;g<u;g++)o[g]=t.getInt32(l+8*g,!n)/t.getInt32(l+4+8*g,!n);return o}}function c(t,e,i){var a="";for(n=e;n<e+i;n++)a+=String.fromCharCode(t.getUint8(n));return a}function g(t,e){if("Exif"!=c(t,e,4))return!1;var i,n=e+6;if(18761==t.getUint16(n))i=!1;else{if(19789!=t.getUint16(n))return!1;i=!0}if(42!=t.getUint16(n+2,!i))return!1;var s=t.getUint32(n+4,!i);return!(s<8)&&function(t,e,i,a,n){var s,o,c=t.getUint16(i,!n),g={};for(o=0;o<c;o++)s=i+12*o+2,g[a[t.getUint16(s,!n)]]=r(t,s,e,0,n);return g}(t,n,n+s,a,i)}i.getData=function(t,e){return!((t instanceof Image||t instanceof HTMLImageElement)&&!t.complete)&&(s(t)?e&&e.call(t):o(t,e),!0)},i.getTag=function(t,e){if(s(t))return t.exifdata[e]},t.exports=i},"3Uj3":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAA4CAYAAABHRFAgAAAAAXNSR0IArs4c6QAAAjRJREFUaAXd20lOw0AQBVDMNbgKB2HHBgKEKQwhzByAeQ5hyI5bcJGsyQrEErEB8xuRqGL5L6ukfEsl2R2pq5+cod1dGRkJOvI8X0a8IzqI8aC0cWmA2kfYoxOXPSATZHtW93/+EZA6JgVAuyXA1NSIGYFzFkC2CfDQOXVM98BtEeBRzAicswC3SYDHzqljugeuQYAnMSNwzgLcBgGeOqeO6R64OgGexYzAOQtw6wR47pw6pnvg1gjwImYEzlmAWyHAS+fUMd0DVyPAq5gROGcBLj1NlB3XzqljuodsqUyHthtEFjMKxyxALBLgrQpwgQCbKsB5ArxTAVYJsKUCnAPkpwR5rwKcJcAHFeAMAT6qACsE+KQCnCbANtpHHX+C3bv+m6UAMYVMLURx1vKCtiriGzGMRzfLsq8MwAmM/hlRBA4jqjjmTzRMJuQrTsaKrwpdd9NnTfEODtyjhKwj8oFWnYv0dq31vngquGgiindV4ounf8/w2WSTgDZeG+qfkD4ynQDDpnMak4GeFlA2MdeY1hkoe8TSmKAbKHtY1njUMlC27KHx0GygbAFLY/nDQNlSpMZCloGyRWWNJUkDZdsDGovLBso2ejS2CQx0FZOGskNjw8dA2d6kxtadgbJdZo1NWANl9QIa2+kGyio/NAojDJTV8GiUuBgoq8bSKFYyUFZXp1F2ZqCsQlKjgNBAd8pmC2jTKAU1UO2iXgPVLs820IPCW1er0N5A0/PoG6KDCP3LxC8932t7kbH07QAAAABJRU5ErkJggg=="},"9uyX":function(t,e){},A1tS:function(t,e,i){t.exports=i.p+"static/img/1.36d8077.png"},FF7V:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("7+uW"),n={name:"App",created:function(){document.querySelector("body").addEventListener("touchmove",function(t){t.preventDefault()},!1)}},s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var o=i("VU/8")(n,s,!1,function(t){i("9uyX")},null,null).exports,r=i("/ocq"),c=i("0Rhb"),g=i.n(c),d={name:"UploadFile",data:function(){return{wrapper:{backgroundImage:"url("+i("cf+J")+")",backgroundSize:"100% 100%"},uploadDiv:{backgroundImage:"url("+i("Ysra")+")",backgroundSize:"100% 100%"},img:new Image,orientation:null}},methods:{uploadImage:function(t){var e=this,i=this,a=new FileReader,n=t.target.files[0];n.size>3145728?alert("上传的图片过大，请重新选择"):(g.a.getData(n,function(){i.orientation=g.a.getTag(this,"Orientation")}),a.onload=function(t){i.img.src=t.target.result,i.img.onload=function(){var t=i.img.width,a=i.img.height;t>a&&t>750?(t=750,a=Math.ceil(750*i.img.height/i.img.width)):t<a&&a>1334&&(t=Math.ceil(1334*i.img.width/i.img.height),a=1334);var n=document.createElement("canvas"),s=n.getContext("2d");if(n.width=t,n.height=a,i.orientation&&1!==i.orientation)switch(i.orientation){case 6:n.width=a,n.height=t,s.rotate(Math.PI/2),s.drawImage(i.img,0,-a,t,a);break;case 3:s.rotate(Math.PI),s.drawImage(i.img,-t,-a,t,a);break;case 8:n.width=a,n.height=t,s.rotate(3*Math.PI/2),s.drawImage(i.img,-t,0,t,a)}else s.drawImage(i.img,0,0,t,a);sessionStorage.setItem("uploadImage",n.toDataURL("image/png",.5)),e.$router.push("/ClipImage")}},a.readAsDataURL(n))}}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper",style:t.wrapper},[i("span",{staticClass:"fileinput_button",style:t.uploadDiv},[i("span",[t._v("上传")]),t._v(" "),i("input",{attrs:{type:"file",accept:"image/gif,image/jpeg,image/jpg,image/png",name:"img"},on:{change:function(e){return t.uploadImage(e)}}})])])},staticRenderFns:[]};var h=i("VU/8")(d,m,!1,function(t){i("FF7V")},"data-v-39c71bb4",null).exports,u={name:"ClipImage",data:function(){return{canvas:null,ctx:null,img:new Image,bgimg:new Image,imgIsLoaded:!1,nameIsLoaded:!1,hintIsShow:!1,imgX:0,imgY:0,imgWidth:0,imgHeight:0,imgScale:1,backgroundImage:i("Nzgg"),keyword:"请输入您的姓名",templateIndex:1}},mounted:function(){this.canvas=this.$refs.myCanvas,this.canvas.width=document.documentElement.clientWidth*window.devicePixelRatio,this.canvas.height=document.documentElement.clientHeight*window.devicePixelRatio,this.canvas.style.width="100%",this.canvas.style.height="100%",this.ctx=this.canvas.getContext("2d"),this.loadImg(),this.loadTemplate()},watch:{keyword:function(t,e){this.drawImage()}},computed:{keywordClass:function(){return{right_1:1===this.templateIndex,left_2:2===this.templateIndex,left_3:3===this.templateIndex}}},methods:{loadImg:function(){var t=this;this.img.src=sessionStorage.getItem("uploadImage"),this.img.crossOrigin="Anonymous",this.img.onload=function(e){var i=750/t.img.width,a=1334/t.img.height,n=i>a?i:a;t.imgWidth=t.img.width*n,t.imgHeight=t.img.height*n,t.drawImage(),t.drag()}},loadTemplate:function(){var t=this;this.bgimg.src=this.backgroundImage,this.bgimg.onload=function(e){t.drawTemplate()}},drawImage:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.img,this.imgX,this.imgY,this.imgWidth*this.imgScale,this.imgHeight*this.imgScale),this.drawTemplate()},drawTemplate:function(){this.ctx.drawImage(this.bgimg,0,0,this.canvas.width,this.canvas.height)},drawName:function(){var t,e,i=16*window.devicePixelRatio;switch(this.ctx.font="bold "+i+"px SimSun",this.ctx.fillStyle="#172A88",this.ctx.textAlign="center",this.templateIndex){case 1:t=3.16*this.canvas.width/4,e=6.08*this.canvas.height/11;break;case 2:t=.68*this.canvas.width/4,e=6.03*this.canvas.height/11;break;case 3:t=.8*this.canvas.width/4,e=5.93*this.canvas.height/11}this.ctx.fillText(this.keyword,t,e)},drag:function(){var t=this,e=!1,i=0,a=0,n=0,s=0,o=0,r=0;this.canvas.addEventListener("touchstart",function(r,c){var g=r.touches[0],d=r.touches[1],m=r.touches.length;e=!0,2===m?(t.imgWidth=t.imgWidth*t.imgScale,t.imgHeight=t.imgHeight*t.imgScale,o=Math.pow(g.pageX-d.pageX,2)+Math.pow(g.pageY-d.pageY,2)):1===m&&(i=g.pageX,a=g.pageY,n=t.imgX,s=t.imgY)}),this.canvas.addEventListener("touchmove",function(c,g){var d=c.touches[0],m=c.touches[1],h=c.touches.length;e&&(2===h?(r=Math.pow(d.pageX-m.pageX,2)+Math.pow(d.pageY-m.pageY,2),t.imgScale=Math.sqrt(r)/Math.sqrt(o)):1===h&&(t.imgX=d.pageX-i+n,t.imgY=d.pageY-a+s),t.drawImage())}),this.canvas.addEventListener("touchend",function(t){e=!1})},changeTemplate:function(t){var e=this;switch(t){case 1:this.backgroundImage=i("Nzgg"),this.templateIndex=1;break;case 2:this.backgroundImage=i("x5/u"),this.templateIndex=2;break;case 3:this.backgroundImage=i("NWuT"),this.templateIndex=3}this.bgimg.src=this.backgroundImage,this.bgimg.onload=function(t){e.drawImage()}},editName:function(){"请输入您的姓名"===this.keyword&&(this.keyword="")},goBack:function(){this.$router.go(-1)},goPrevious:function(){this.changeTemplate(this.templateIndex),this.nameIsLoaded=!1},saveImage:function(){var t=this;switch(this.templateIndex){case 1:this.backgroundImage=i("A1tS");break;case 2:this.backgroundImage=i("chPc");break;case 3:this.backgroundImage=i("ZK0V")}this.bgimg.src=this.backgroundImage,this.bgimg.onload=function(e){t.drawImage(),t.nameIsLoaded=!0}},generatePost:function(){"请输入您的姓名"!==this.keyword?this.keyword.length>10?alert("最多输入10个字"):(this.drawName(),this.$refs.myImg.src=this.canvas.toDataURL("image/png"),this.imgIsLoaded=!0,this.nameIsLoaded=!1,this.hintIsShow=!0):alert("请填写姓名～")},closeHint:function(){this.hintIsShow=!1},handleKeyword:function(){""===this.keyword&&(this.keyword="请输入您的姓名")},handleKeywordFocus:function(){this.$refs.keyword.style.animation="none"}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"full-screen"},[a("canvas",{directives:[{name:"show",rawName:"v-show",value:!t.imgIsLoaded,expression:"!imgIsLoaded"}],ref:"myCanvas"}),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.imgIsLoaded,expression:"imgIsLoaded"}],ref:"myImg",staticClass:"full-screen"}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.hintIsShow,expression:"hintIsShow"}],staticClass:"cover full-screen fixed",on:{click:t.closeHint}},[a("img",{staticClass:"save_hint",attrs:{src:i("iFoD")}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.nameIsLoaded&&!t.imgIsLoaded,expression:"!nameIsLoaded && !imgIsLoaded"}],staticClass:"toolkit fixed"},[a("div",{staticClass:"tookit_item",on:{click:t.goBack}},[a("img",{staticClass:"arrow",attrs:{src:i("3Uj3")}})]),t._v(" "),a("div",{staticClass:"tookit_item"},[a("img",{staticClass:"template_background",class:{checked:1===t.templateIndex},attrs:{src:i("Nzgg")},on:{click:function(e){return t.changeTemplate(1)}}})]),t._v(" "),a("div",{staticClass:"tookit_item"},[a("img",{staticClass:"template_background",class:{checked:2===t.templateIndex},attrs:{src:i("x5/u")},on:{click:function(e){return t.changeTemplate(2)}}})]),t._v(" "),a("div",{staticClass:"tookit_item"},[a("img",{staticClass:"template_background",class:{checked:3===t.templateIndex},attrs:{src:i("NWuT")},on:{click:function(e){return t.changeTemplate(3)}}})]),t._v(" "),a("div",{staticClass:"tookit_item",on:{click:t.saveImage}},[a("span",{staticClass:"next"},[t._v("下一步")])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.nameIsLoaded,expression:"nameIsLoaded"}],staticClass:"toolkit fixed"},[a("div",{staticClass:"tookit_item",on:{click:t.goPrevious}},[a("img",{staticClass:"arrow",attrs:{src:i("3Uj3")}})]),t._v(" "),a("div",{staticClass:"tookit_item"}),t._v(" "),a("div",{staticClass:"tookit_item"}),t._v(" "),a("div",{staticClass:"tookit_item"}),t._v(" "),a("div",{staticClass:"tookit_item",on:{click:t.generatePost}},[a("span",{staticClass:"next"},[t._v("下一步")])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.nameIsLoaded,expression:"nameIsLoaded"}],staticClass:"keyword fixed",class:t.keywordClass,on:{click:t.editName}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],ref:"keyword",attrs:{type:"text"},domProps:{value:t.keyword},on:{blur:function(e){return e.preventDefault(),t.handleKeyword(e)},focus:t.handleKeywordFocus,input:function(e){e.target.composing||(t.keyword=e.target.value)}}})])])},staticRenderFns:[]};var p=i("VU/8")(u,l,!1,function(t){i("kkOJ")},"data-v-1b365910",null).exports;a.a.use(r.a);var f=new r.a({routes:[{path:"/",name:"UploadFile",component:h},{path:"/clipImage",name:"ClipImage",component:p}]});i("oAV5");a.a.config.productionTip=!1,new a.a({el:"#app",router:f,components:{App:o},template:"<App/>"})},NWuT:function(t,e,i){t.exports=i.p+"static/img/template3.36d8077.png"},Nzgg:function(t,e,i){t.exports=i.p+"static/img/template1.36d8077.png"},Ysra:function(t,e,i){t.exports=i.p+"static/img/upload.6c41ad5.png"},ZK0V:function(t,e,i){t.exports=i.p+"static/img/3.36d8077.png"},"cf+J":function(t,e,i){t.exports=i.p+"static/img/background.e051ed8.png"},chPc:function(t,e,i){t.exports=i.p+"static/img/2.210f414.png"},iFoD:function(t,e,i){t.exports=i.p+"static/img/save.2a67ce7.png"},kkOJ:function(t,e){},oAV5:function(t,e){window.alert=function(t){var e=document.createElement("IFRAME");e.style.display="none",e.setAttribute("src","data:text/plain,"),document.documentElement.appendChild(e),window.frames[0].window.alert(t),e.parentNode.removeChild(e)}},"x5/u":function(t,e,i){t.exports=i.p+"static/img/template2.210f414.png"}},["NHnr"]);
//# sourceMappingURL=app.c3bcf4a83081b16a864a.js.map